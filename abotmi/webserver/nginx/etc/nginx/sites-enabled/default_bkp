server {
    listen 80 default_server;
    # Make site accessible from http://localhost/
    server_name [SERVER_NAME];
    return 301 https://[SERVER_NAME]$request_uri;
}

server {
    listen 443;
    server_name [SERVER_NAME];
    client_max_body_size 50M;

    # SSL SETTINGS
    ssl on;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    ssl_dhparam   /etc/nginx/keygroup/dhsecure.pem;
    ssl_certificate      /etc/ssl/upwrdz/upwrdz.crt;
    ssl_certificate_key  /etc/ssl/upwrdz/upwrdz.key;
    ssl_trusted_certificate /etc/ssl/upwrdz/upwrdz-ca-inter.cer;

    # Adding Headers for site
    add_header           Front-End-Https    on;
    add_header Content-Security-Policy "script-src 'self' 'unsafe-inline' 'unsafe-eval' *.google.com *.gstatic.com *.googleapis.com *.facebook.com *.linkedin.com *.twitter.com *.clickmeeting.com *.meetup.com stream.ac.in uplyf.com test.uplyf.com icoreindia.com *.tawk.to *.facebook.net *.youtube.com s.ytimg.com upwrdz.com cdn.jsdelivr.net;";
    add_header X-Frame-Options SAMEORIGIN;
    add_header X-Content-Type-Options nosniff;
    add_header X-Xss-Protection "1; mode=block";

    # LOG FILES
    access_log      /var/log/nginx/nf.access.log;
    error_log       /var/log/nginx/nf.error.log;


    keepalive_timeout    70;
    root /home/northfacing/;

    # Only allow specific request methods
    if ($request_method !~ ^(GET|HEAD|POST|DELETE|PUT|PATCH|OPTIONS)$ ) { return 444; }

    location / {
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_redirect off;
        proxy_cookie_path / "/; secure; HttpOnly";
        proxy_http_version 1.1;
        proxy_pass http://127.0.0.1:8000;
    }

    location /static/ {
        try_files $uri /;
    }
}